meraki:
  template:
    networks:
      - name: product_types
        product_types:
                - appliance
                - switch
                - wireless
                - camera
                - sensor
                - cellularGateway      
      - name: network_settings
        settings:
          local_status_page_enabled: true
          remote_status_page: true
          secure_port: false
          local_status_page_authentication:
            username: ${local_status_page_username}
            password: "mEraki123%"
          named_vlans: true   
      - name: snmp
        snmp:
          access: users
          users:
            - username: ${snmp_username}
              passphrase: Cisco123
      - name: syslog
        syslog_servers:
          - host: ${syslog_server}
            port: 514
            roles:
              - Switch event log
              - Air Marshal events
              - Flows
              - URLs
              - Wireless event log
              - Appliance event log
      - name: nw_switch
        switch:
          settings:
            vlan: 1
            use_combined_power: false
            uplink_client_sampling: true
            mac_blocklist: false
          mtu:
            default_mtu_size: 9100
          dhcp_server_policy:
            default_policy: allow
          dscp_to_cos_mappings:
            - cos: 0
              dscp: 8
              title: Scavenger CS1
            - cos: 0
              dscp: 10
              title: Bulk AF11
            - cos: 0
              dscp: 12
              title: Bulk AF12
            - cos: 0
              dscp: 14
              title: Bulk AF13
            - cos: 1
              dscp: 0
              title: Default CS0
            - cos: 2
              dscp: 16
              title: Network Mgmt CS2
            - cos: 2
              dscp: 18
              title: Transactional Data AF21
            - cos: 2
              dscp: 20
              title: Transactional Data AF22
            - cos: 2
              dscp: 22
              title: Transactional Data AF23
            - cos: 2
              dscp: 24
              title: Signaling CS3
            - cos: 3
              dscp: 26
              title: Multimedia Streaming AF31
            - cos: 3
              dscp: 28
              title: Multimedia Streaming AF32
            - cos: 3
              dscp: 30
              title: Multimedia Streaming AF33
            - cos: 3
              dscp: 40
              title: Broadcast Video CS5
            - cos: 4
              dscp: 32
              title: Realtime Interactive CS4
            - cos: 4
              dscp: 34
              title: Multimedia Conferencing AF41
            - cos: 4
              dscp: 36
              title: Multimedia Conferencing AF42
            - cos: 4
              dscp: 38
              title: Multimedia Conferencing AF43
            - cos: 5
              dscp: 44
              title: Admission-Controlled Voice EF
            - cos: 5
              dscp: 46
              title: Voice EF
            - cos: 5
              dscp: 48
              title: Internetwork Control CS6
            - cos: 5
              dscp: 56
              title: Network Control CS7
          qos_rules:
              - vlan: 20
                protocol: ANY
                dscp: -1
                qos_rule_name: Trust_DSCP_Voice_VLAN
              - vlan: 30
                protocol: ANY
                dscp: 0
                qos_rule_name: Remark_Guest_to_Default
              - vlan: 10
                protocol: UDP
                source_port_range: 16384-32767
                destination_port_range: 16385-32767
                dscp: 46
                qos_rule_name: Voice_to_EF_Data_VLAN
              - vlan: 10
                protocol: ANY
                dscp: 0
                qos_rule_name: Other_to_Default_Data_VLAN
          storm_control:
              broadcast_threshold: 30
              multicast_threshold: 30
              unknown_unicast_threshold: 30
          port_schedules:
                  - name: Weekend Only Port Schedule
                    port_schedule:
                        friday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        monday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        saturday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        sunday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        thursday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        tuesday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        wednesday:
                            active: true
                            from: 00:00
                            to: '24:00'
      - name: wireless
        wireless:
                  settings:
                    meshing: false
                    ipv6_bridge: true
                    location_analytics: true
                    led_lights_on: true
                    upgrade_strategy: minimizeClientDowntime
                    named_vlans_pool_dhcp_monitoring:
                      enabled: false
                      duration: 5
                  rf_profiles:
                    - name: Corp wireless rf profile
                      client_balancing: true
                      min_bitrate_type: band
                      band_selection_type: ssid
                      ap_band_settings:
                      two_four_ghz_settings:
                        max_power: 30
                        min_power: 10
                        min_bitrate: 11
                        valid_auto_channels:
                            - 1
                            - 6
                            - 11
                        ax: true
                        rxsop: -80
                      five_ghz_settings:
                        max_power: 30
                        min_power: 10
                        min_bitrate: 9
                        valid_auto_channels:
                            - 36
                            - 40
                            - 44
                            - 48
                            - 157
                            - 161
                        channel_width: "80"
                        rxsop: -80
                      transmission: true
                      per_ssid_settings:
                        - ssid_name: "Guest"
                          min_bitrate: 11
                          band_operation_mode: 5ghz
                          bands:
                            - "5"
                          band_steering: true
                      is_indoor_default: true
                      is_outdoor_default: true
                  ssids:
                    - name: Data
                      ssid_number: '0'
                      traffic_shaping_rules:
                        default_rules: false
                        traffic_shaping: true
                        rules:
                          - definitions:
                              - type: application
                                value: meraki:layer7/application/332
                              - type: application
                                value: meraki:layer7/application/2249
                              - type: application
                                value: meraki:layer7/application/351
                              - type: application
                                value: meraki:layer7/application/2248
                              - type: application
                                value: meraki:layer7/application/2542
                            per_client_bandwidth_limits:
                              settings: custom
                              bandwidth_limits:
                                limit_up: 1000
                                limit_down: 1000
                            dscp_tag_value: 16
                          - definitions:
                              - type: host
                                value: nms.example.com
                              - type: ipRange
                                value: 158.43.128.0/24
                              - type: localNet
                                value: 192.168.0.0/16
                              - type: port
                                value: "161"
                            per_client_bandwidth_limits:
                              settings: network default
                            dscp_tag_value: 24
                      per_client_bandwidth_limit_down: 0
                      per_client_bandwidth_limit_up: 0
                      per_ssid_bandwidth_limit_down: 0
                      per_ssid_bandwidth_limit_up: 0
                      splash_page: None
                      enabled: true
                      ip_assignment_mode: Bridge mode
                      use_vlan_tagging: true
                      default_vlan_id: ${default-vlan-id-data}
                      ap_tags_and_vlan_ids:
                        - tags: 
                          - ${ap-tag1}
                          vlan_id: ${ap-tag1-vlan-id}
                        - tags:
                          - ${ap-tag2}
                          vlan_id: ${ap-tag1-vlan-id}
                      schedules:
                        enabled: ${data_ssid_schedules_enabled}
                        ranges:
                          - start_day: Sunday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Sunday
                          - start_day: Saturday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Saturday
                    - name: Voice
                      ssid_number: '1'
                      traffic_shaping_rules:
                        default_rules: false
                        traffic_shaping: true
                        rules:
                          - definitions:
                              - type: applicationCategory
                                value: "meraki:layer7/category/16"
                            per_client_bandwidth_limits:
                              settings: ignore
                            dscp_tag_value: 46
                            pcp_tag_value: 7
                      per_client_bandwidth_limit_down: 0
                      per_client_bandwidth_limit_up: 0
                      per_ssid_bandwidth_limit_down: 0
                      per_ssid_bandwidth_limit_up: 0
                      splash_page: None
                      enabled: true
                      ip_assignment_mode: Bridge mode
                      use_vlan_tagging: true
                      default_vlan_id: ${default-vlan-id-data}
                      ap_tags_and_vlan_ids:
                        - tags: 
                          - ${ap-tag1}
                          vlan_id: ${ap-tag1-vlan-id}
                        - tags:
                          - ${ap-tag2}
                          vlan_id: ${ap-tag1-vlan-id}
                      schedules:
                        enabled: ${voice_ssid_schedules_enabled}
                        ranges:
                          - start_day: Sunday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Sunday
                          - start_day: Saturday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Saturday  
                    - name: Guest
                      ssid_number: '2'
                      traffic_shaping_rules:
                        default_rules: true
                        traffic_shaping: true
                      per_client_bandwidth_limit_down: 10000
                      per_client_bandwidth_limit_up: 10000
                      per_ssid_bandwidth_limit_down: 100000
                      per_ssid_bandwidth_limit_up: 100000
                      enabled: true
                      ip_assignment_mode: Bridge mode
                      use_vlan_tagging: true
                      default_vlan_id: ${default-vlan-id-data}
                      ap_tags_and_vlan_ids:
                        - tags: 
                          - ${ap-tag1}
                          vlan_id: ${ap-tag1-vlan-id}
                        - tags:
                          - ${ap-tag2}
                          vlan_id: ${ap-tag1-vlan-id}   
                      splash_page: Click-through splash page
                      splash_settings:
                        allow_simultaneous_logins: true
                        billing:
                            free_access:
                                duration_in_minutes: 20
                                enabled: false
                            reply_to_email_address: digidev.gen@cisco.com
                        block_all_traffic_before_sign_on: true
                        controller_disconnection_behavior: default
                        guest_sponsorship:
                            guest_can_request_timeframe: false
                        splash_timeout: 1440
                        use_redirect_url: false
                        use_splash_url: false
                      schedules:
                        enabled: ${guest_ssid_schedules_enabled}
                        ranges:
                          - start_day: Sunday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Sunday
                          - start_day: Saturday
                            start_time: 00:00:00
                            end_time: 06:00:00
                            end_day: Saturday
      - name: nw_switch1
        switch:
          settings:
            vlan: 1
            use_combined_power: false
            uplink_client_sampling: true
            mac_blocklist: false
          mtu:
            default_mtu_size: 9100
          dhcp_server_policy:
            default_policy: allow
          dscp_to_cos_mappings:
            - cos: 0
              dscp: 8
              title: Scavenger CS1
            - cos: 0
              dscp: 10
              title: Bulk AF11
            - cos: 0
              dscp: 12
              title: Bulk AF12
            - cos: 0
              dscp: 14
              title: Bulk AF13
            - cos: 1
              dscp: 0
              title: Default CS0
            - cos: 2
              dscp: 16
              title: Network Mgmt CS2
            - cos: 2
              dscp: 18
              title: Transactional Data AF21
            - cos: 2
              dscp: 20
              title: Transactional Data AF22
            - cos: 2
              dscp: 22
              title: Transactional Data AF23
            - cos: 2
              dscp: 24
              title: Signaling CS3
            - cos: 3
              dscp: 26
              title: Multimedia Streaming AF31
            - cos: 3
              dscp: 28
              title: Multimedia Streaming AF32
            - cos: 3
              dscp: 30
              title: Multimedia Streaming AF33
            - cos: 3
              dscp: 40
              title: Broadcast Video CS5
            - cos: 4
              dscp: 32
              title: Realtime Interactive CS4
            - cos: 4
              dscp: 34
              title: Multimedia Conferencing AF41
            - cos: 4
              dscp: 36
              title: Multimedia Conferencing AF42
            - cos: 4
              dscp: 38
              title: Multimedia Conferencing AF43
            - cos: 5
              dscp: 44
              title: Admission-Controlled Voice EF
            - cos: 5
              dscp: 46
              title: Voice EF
            - cos: 5
              dscp: 48
              title: Internetwork Control CS6
            - cos: 5
              dscp: 56
              title: Network Control CS7
          qos_rules:
              - vlan: 20
                protocol: ANY
                dscp: -1
                qos_rule_name: Trust_DSCP_Voice_VLAN
              - vlan: 30
                protocol: ANY
                dscp: 0
                qos_rule_name: Remark_Guest_to_Default
              - vlan: 10
                protocol: UDP
                source_port_range: 16384-32767
                destination_port_range: 16385-32767
                dscp: 46
                qos_rule_name: Voice_to_EF_Data_VLAN
              - vlan: 10
                protocol: ANY
                dscp: 0
                qos_rule_name: Other_to_Default_Data_VLAN
          port_schedules:
                  - name: Weekend Only Port Schedule
                    port_schedule:
                        friday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        monday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        saturday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        sunday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        thursday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        tuesday:
                            active: true
                            from: 00:00
                            to: '24:00'
                        wednesday:
                            active: true
                            from: 00:00
                            to: '24:00'